import base64
import hashlib
import os
from typing import Union

here = os.path.abspath(os.path.dirname(__file__))


def hash_calc(hash_type: str, binary: bytes, output_type: str) -> Union[str, bytearray]:
    hash_type = hash_type.upper()
    algo = hashlib.new(hash_type)
    algo.update(binary)

    if output_type == 'hex':
        return algo.hexdigest()
    elif output_type == 'base64':
        return base64.standard_b64encode(algo.digest()).decode('ascii')
    elif output_type == 'base32':
        return base64.b32encode(algo.digest()).decode('ascii')
    elif output_type == 'base16':
        return base64.b16encode(algo.digest()).decode('ascii')
    else:
        return algo.digest()
