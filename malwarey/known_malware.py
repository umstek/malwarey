import os

here = os.path.abspath(os.path.dirname(__file__))

haystack = bytearray()
for file_path in os.listdir(here + '/known_md5_bin'):
    with open(here + '/known_md5_bin/' + file_path, mode='rb') as file:
        haystack.extend(file.read())


def is_known_malware(needle_md5: bytearray) -> bool:
    i = 0
    while i < len(haystack):
        if needle_md5 == haystack[i:i + 16]:
            return True
        i += 16

    return False
